<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" charset="UTF-8">
    <title>学生管理系统</title>
    <!-- 新 Bootstrap 核心 CSS 文件 -->
    <link href="../dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="../dist/css/1.css" rel="stylesheet">
    <link rel="stylesheet" href="../dist/css/bootstrapValidator.css"/>
    <!-- jQuery文件。务必在bootstrap.min.js 之前引入 -->
    <script type="text/javascript" src="../dist/js/jquery/jquery.min.js"></script>
    <!-- 最新的 Bootstrap 核心 JavaScript 文件 -->
    <script src="../dist/js/bootstrap/bootstrap.min.js"></script>
    <script type="text/javascript" src="../dist/js/bootstrap/bootstrapValidator.js"></script>
    <script src="../dist/js/1.js"></script>
</head>

<body onload="SelectClass()">
<div class="topnav">
    <ul>
        <a class="active" href="../index.html"><span class="glyphicon glyphicon-home"></span> 主页</a>
        <a href="../show/showstudent.html" target="_self">学生</a>
        <a href="../show/showteacher.html">教师</a>
        <a href="../show/showclass.html">班级</a>
        <a href="../show/showmajor.html">专业</a>
        <a href="#about" style="float:right">关于 <span class="glyphicon glyphicon-info-sign"></span></a>
    </ul>
</div>
<div class="row">
    <div class="panel-group col-sm-2" id="panelContainer">
        <div class="panel panel-default">
            <div id="header1" class="panel-heading" data-toggle="collapse" data-target="#sub1" data-parent="#panelContainer">
                <i class="glyphicon glyphicon-user"></i>
                <a href="#">学生管理</a>
                <span class="glyphicon glyphicon-triangle-right pull-right"></span>
            </div>
            <div id="sub1" class="collapse panel-collapse">
                <div class="panel-body">
                    <ul class="nav">
                        <li>
                            <a href="../show/showstudent.html">
                        <span class="glyphicon glyphicon-align-left" aria-hidden="true">
                        </span>学生信息录入</a>
                        </li>
                        <li>
                            <a href="newstudent.html">
                        <span class="glyphicon glyphicon-plus" aria-hidden="true">
                        </span>学生信息新增</a>
                        </li>
                        <li>
                            <a href="../show/showstudent.html">
                        <span class="glyphicon glyphicon-minus" aria-hidden="true">
                        </span>学生信息删除</a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
        <div class="panel panel-default">
            <div id="header2" class="panel-heading" data-toggle="collapse" data-target="#sub2" data-parent="#panelContainer">
                <i class="glyphicon glyphicon-book"></i>
                <a href="#">教师管理</a>
                <span class="glyphicon glyphicon-triangle-right pull-right"></span>
            </div>
            <div id="sub2" class="collapse panel-collapse">
                <div class="panel-body">
                    <ul class="nav">
                        <li>
                            <a href="../show/showteacher.html">
                        <span class="glyphicon glyphicon-align-left" aria-hidden="true">
                        </span>教师信息录入</a>
                        </li>
                        <li>
                            <a href="newteacher.html">
                        <span class="glyphicon glyphicon-plus" aria-hidden="true">
                        </span>教师信息新增</a>
                        </li>
                        <li>
                            <a href="../show/showteacher.html">
                        <span class="glyphicon glyphicon-minus" aria-hidden="true">
                        </span>教师信息删除</a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
        <div class="panel panel-default">
            <div id="header3" class="panel-heading" data-toggle="collapse" data-target="#sub3" data-parent="#panelContainer">
                <i class="glyphicon glyphicon-list-alt"></i>
                <a href="#">班级管理</a>
                <span class="glyphicon glyphicon-triangle-right pull-right"></span>
            </div>
            <div id="sub3" class="collapse panel-collapse">
                <div class="panel-body">
                    <ul class="nav">
                        <li>
                            <a href="../show/showclass.html">
                        <span class="glyphicon glyphicon-align-left" aria-hidden="true">
                        </span>班级信息录入</a>
                        </li>
                        <li>
                            <a href="newclass.html">
                        <span class="glyphicon glyphicon-plus" aria-hidden="true">
                        </span>班级信息新增</a>
                        </li>
                        <li>
                            <a href="../show/showclass.html">
                        <span class="glyphicon glyphicon-minus" aria-hidden="true">
                        </span>班级信息删除</a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
        <div class="panel panel-default">
            <div id="header4" class="panel-heading" data-toggle="collapse" data-target="#sub4" data-parent="#panelContainer">
                <i class="glyphicon glyphicon-leaf"></i>
                <a href="#">专业管理</a>
                <span class="glyphicon glyphicon-triangle-right pull-right"></span>
            </div>
            <div id="sub4" class="collapse panel-collapse">
                <div class="panel-body">
                    <ul class="nav">
                        <li>
                            <a href="../show/showmajor.html">
                        <span class="glyphicon glyphicon-align-left" aria-hidden="true">
                        </span>专业信息录入</a>
                        </li>
                        <li>
                            <a href="newmajor.html">
                        <span class="glyphicon glyphicon-plus" aria-hidden="true">
                        </span>专业信息新增</a>
                        </li>
                        <li>
                            <a href="../show/showmajor.html">
                        <span class="glyphicon glyphicon-minus" aria-hidden="true">
                        </span>专业信息删除</a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
    <div class="col-sm-10">
        <ol class="breadcrumb">
            <li class="active">菜单
            </li>
            <li class="active">学生信息
            </li>
        </ol>
        <!--class属性在css用 action属性后接映射名在控制器里面有 method属性一般都是post -->
            <form id="Form" method="post" class="form-horizontal"
                  data-bv-message="This value is not valid"
                  data-bv-feedbackicons-valid="glyphicon glyphicon-ok"
                  data-bv-feedbackicons-invalid="glyphicon glyphicon-remove"
                  data-bv-feedbackicons-validating="glyphicon glyphicon-refresh">
                <div class="form-group">
                    <label class="col-lg-3 control-label">姓名</label>
                    <div class="col-lg-4">
                        <input type="text" class="form-control" name="name" placeholder="姓名" required data-bv-notempty-message="姓名不能为空" />
                        <!--type说明他是文本输入框  name后接实体类的类成员名字，不然传不出去！！-->
                    </div>
                </div>

                <div class="form-group">
                    <label class="col-lg-3 control-label">学号</label>
                    <div class="col-lg-4">
                        <input type="text" class="form-control" name="student_id"
                               placeholder="默认为10位数字"
                               data-bv-message="无效的学号"
                               required data-bv-notempty-message="学号必须填写且不能为空"
                               pattern="^[0-9]+$" data-bv-regexp-message="学号只能由数字组成"
                               data-bv-stringlength="true" data-bv-stringlength-min="10" data-bv-stringlength-max="10" data-bv-stringlength-message="学号长度必须为10位"
                        />
                    </div>
                </div>

                <div class="form-group">
                    <label class="col-lg-3 control-label">电子邮箱</label>
                    <div class="col-lg-4">
                        <input class="form-control" name="email" placeholder="非必填项" type="email" data-bv-emailaddress-message="无效的邮箱地址" />
                    </div>
                </div>
                <div class="form-group">
                    <label class="col-lg-3 control-label">性别</label>
                    <div class="col-lg-4">
                        <div class="radio">
                            <label>
                                <input type="radio" name="gender" value="男" required data-bv-notempty-message="需要选择性别" /> 男
                            </label>
                        </div>
                        <div class="radio">
                            <label>
                                <input type="radio" name="gender" value="女" /> 女
                            </label>
                        </div>
                        <div class="radio">
                            <label>
                                <input type="radio" name="gender" value="其他" /> 其他
                            </label>
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <label class="col-lg-3 control-label">所属班级</label>
                    <div class="col-lg-4">
                        <select id="select_class" class="form-control" name="clazz" data-bv-notempty data-bv-notempty-message="需要选择一项">
                            <option value="">-- Select a class --</option>
                        </select>
                    </div>
                </div>
                <div class="form-group">
                    <label class="col-lg-3 control-label">出生日期</label>
                    <div class="col-lg-4">
                        <input type="text" class="form-control" name="birth" data-bv-date="false" data-bv-date-format="YYYY/MM/DD" data-bv-date-message="无效的出生日期" required data-bv-notempty-message="需要填写出生日期" /> (YYYY/MM/DD)
                    </div>
                </div>

                <div class="form-group">
                    <label class="col-lg-3 control-label">编程语言</label>
                    <div class="col-lg-4">
                        <div class="checkbox">
                            <label>
                                <input type="checkbox" name="programs[]" value="net" data-bv-choice="true" data-bv-choice-min="2" data-bv-choice-max="4" data-bv-choice-message="请选择2-4门你擅长的编程语言" /> .Net
                            </label>
                        </div>
                        <div class="checkbox">
                            <label>
                                <input type="checkbox" name="programs[]" value="java" /> Java
                            </label>
                        </div>
                        <div class="checkbox">
                            <label>
                                <input type="checkbox" name="programs[]" value="c" /> C/C++
                            </label>
                        </div>
                        <div class="checkbox">
                            <label>
                                <input type="checkbox" name="programs[]" value="php" /> PHP
                            </label>
                        </div>
                        <div class="checkbox">
                            <label>
                                <input type="checkbox" name="programs[]" value="perl" /> Perl
                            </label>
                        </div>
                        <div class="checkbox">
                            <label>
                                <input type="checkbox" name="programs[]" value="ruby" /> Ruby
                            </label>
                        </div>
                        <div class="checkbox">
                            <label>
                                <input type="checkbox" name="programs[]" value="python" /> Python
                            </label>
                        </div>
                        <div class="checkbox">
                            <label>
                                <input type="checkbox" name="programs[]" value="javascript" /> Javascript
                            </label>
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <div class="col-lg-9 col-lg-offset-3">
                        <button type="submit" class="btn btn-primary">确定</button>
                        <!--提交按钮-->
                        <button type="reset" class="btn btn-default">重置</button>
                    </div>
                </div>
            </form>
</div>
</div>
<script type="text/javascript">
    $(document).ready(function() {
        $('#Form').bootstrapValidator();
        $(':submit').on('click',function(){//非submit按钮点击后进行验证，如果是submit则无需此句直接验证
            $('#Form').bootstrapValidator('validate');//提交验证
            if ($('#Form').data('bootstrapValidator').isValid()) {//获取验证结果，如果成功，执行下面代码
                $.ajax({
                    url:"/student/add",                //提交到的url
                    type:"POST",                      //数据提交方式(post/get)
                    data:JSON.stringify($('form').serializeObject()),
                    contentType:"application/json;charset=UTF-8",   //缺失会出现URL编码，无法转成json对象
                    async: true, // 默认设置下，所有请求均为异步请求。如果设置为false，则发送同步请求
                    // 请求成功后的回调函数。
                    success: function () {
                        alert("添加成功");
                        window.location.href="../show/showstudent.html";
                    },
                });
            }
        });
    });

    /**
     * 自动将form表单封装成json对象
     */
    $.fn.serializeObject = function()
    {
        var o = {};
        var a = this.serializeArray();
        $.each(a, function() {
            if (o[this.name]) {
                if (!o[this.name].push) {
                    o[this.name] = [o[this.name]];
                }
                o[this.name].push(this.value || '');
            } else {
                o[this.name] = this.value || '';
            }
        });
        return o;
    };

    //展示对话框
    var dialog = BootstrapDialog.show({
            size: 'size-wide',
            title: '请填写',
            message: form,
            onshown: function () { //对话框展示时验证表单
                //对话框展示时验证表单
                form.data("bootstrapValidator").validate();
                //开始日期和结束日期修改时，主动触发校验
                form.find('#datetimepicker1').on('changeDate', function () {
                    form.bootstrapValidator('revalidateField', 'startTime');
                    form.bootstrapValidator('revalidateField', 'endTime');
                });
                form.find('#datetimepicker2').on('changeDate', function () {
                    form.bootstrapValidator('revalidateField', 'startTime');
                    form.bootstrapValidator('revalidateField', 'endTime');
                });
            }
        }
    );
    function SelectClass() {
        $.get("/class/query?name=**",
            function (data) {
                var t = $("#select_class");
                if (!data) return;
                data.forEach(function (clazz) {
                    var option = $("<option value=" + clazz.name + ">" + clazz.name + "</option>");
                    option.appendTo(t)
                });
            }, "json");
    }

</script>
<!-- 底部页脚部分 -->
<div class="footer">
    <p class="text-center">
        2020 &copy; Odin.
    </p>
</div>
</body>
</html>
